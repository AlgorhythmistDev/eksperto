<div {{ attributes }} class="space-y-6">
	{{ include(theme.themeDirectory ~ '/partials/_flash_messages.html.twig') }}

	<div class="card bg-base-100 shadow-xl border border-base-200">
		<div class="card-body">
			<h2 class="card-title text-3xl mb-6 flex items-center gap-3">
				<div class="p-2 bg-primary/10 rounded-lg text-primary">
					<i class="i-tabler-calculator"></i>
				</div>
				{% trans %}Inflation Calculator{% endtrans %}
			</h2>

			{# Error Message #}
			{% if this.error %}
				<div role="alert" class="alert alert-error shadow-lg mb-6">
					<i class="i-tabler-alert-circle text-2xl"></i>
					<div>
						<h3 class="font-bold">{% trans %}Error{% endtrans %}</h3>
						<div class="text-sm">{{ this.error }}</div>
					</div>
				</div>
			{% endif %}

			{# Form Section #}
			<div class="flex flex-col gap-6 mb-8">
				<div
					class="grid grid-cols-1 md:grid-cols-2 gap-6">
					{# Start Date #}
					<div class="form-control w-full">
						<label class="label">
							<span class="label-text font-medium text-lg">{% trans %}Start Date{% endtrans %}</span>
						</label>
						<input type="date" class="input input-bordered input-primary w-full input-lg" data-model="startDate" min="2024-01-01" max="2026-02-28">
						<label class="label">
							<span class="label-text-alt opacity-70">{% trans %}Min: Jan 2024{% endtrans %}</span>
						</label>
					</div>

					{# End Date #}
					<div class="form-control w-full">
						<label class="label">
							<span class="label-text font-medium text-lg">{% trans %}End Date{% endtrans %}</span>
						</label>
						<input type="date" class="input input-bordered input-primary w-full input-lg" data-model="endDate" min="2024-01-01" max="2026-02-28">
						<label class="label">
							<span class="label-text-alt opacity-70">{% trans %}Max: Feb 2026{% endtrans %}</span>
						</label>
					</div>
				</div>

				{# Buttons #}
				<div class="flex gap-4">
					<button type="button" class="btn btn-primary btn-lg flex-1 md:flex-none md:min-w-[200px]" data-action="live#action" data-live-action-param="calculate" data-loading="addClass(disabled)">
						<i class="i-tabler-calculator" data-loading="addAttribute(hidden)"></i>
						{% trans %}Calculate{% endtrans %}
					</button>

					<button type="button" class="btn btn-outline btn-lg" data-action="live#action" data-live-action-param="reset" data-loading="addClass(disabled)">
						<i class="i-tabler-refresh"></i>
						{% trans %}Reset{% endtrans %}
					</button>
				</div>
			</div>

			{# Results Section #}
			{% if this.result %}
				<div class="divider"></div>

				{# Stats Component #}
				<div
					class="stats stats-vertical lg:stats-horizontal shadow-lg w-full bg-base-200 mb-8">
					{# Total Inflation #}
					<div class="stat">
						<div class="stat-figure text-primary">
							<i class="i-tabler-chart-arrows-vertical text-3xl"></i>
						</div>
						<div class="stat-title">{% trans %}Total Inflation{% endtrans %}</div>
						<div class="stat-value text-primary">{{ this.result.totalInflation }}%</div>
						<div class="stat-desc">{{ this.result.months }}
							{% trans %}months{% endtrans %}</div>
					</div>

					{# Price Increase #}
					<div class="stat">
						<div class="stat-figure text-secondary">
							<i class="i-tabler-currency-lira text-3xl"></i>
						</div>
						<div class="stat-title">{% trans %}Price Increase{% endtrans %}</div>
						<div class="stat-value text-secondary">₺{{ this.result.priceIncrease }}</div>
						<div class="stat-desc">{% trans %}per 100 TL{% endtrans %}</div>
					</div>
				</div>

				{# Comparison Card #}
				<div class="card bg-base-200 mb-8">
					<div class="card-body">
						<h3 class="card-title text-sm opacity-70 mb-4">
							<i class="i-tabler-info-circle"></i>
							{% trans %}Purchasing Power Comparison{% endtrans %}
						</h3>
						<div class="flex flex-col md:flex-row justify-between items-center gap-6">
							<div class="text-center w-full">
								<div class="text-sm opacity-70 mb-1">{% trans %}Jan 2024{% endtrans %}</div>
								<div class="text-2xl font-bold">₺{{ this.result.basePriceExample }}</div>
							</div>

							<i class="i-tabler-arrow-right text-2xl opacity-50 rotate-90 md:rotate-0"></i>

							<div class="text-center w-full">
								<div class="text-sm opacity-70 mb-1">{% trans %}Today{% endtrans %}</div>
								<div class="text-3xl font-bold text-primary">₺{{ this.result.finalPriceExample }}</div>
							</div>
						</div>
					</div>
				</div>

				{# Monthly Breakdown #}
				{% if this.result.monthlyRates %}
					<div class="collapse collapse-arrow bg-base-100 border border-base-200">
						<input type="checkbox"/>
						<div class="collapse-title text-xl font-medium">
							{% trans %}Monthly Breakdown{% endtrans %}
						</div>
						<div class="collapse-content">
							<div class="overflow-x-auto">
								<table class="table table-zebra">
									<thead>
										<tr>
											<th>{% trans %}Month{% endtrans %}</th>
											<th class="text-right">{% trans %}Rate{% endtrans %}</th>
										</tr>
									</thead>
									<tbody>
										{% for rate in this.result.monthlyRates %}
											<tr>
												<td class="font-medium">{{ rate.month }}</td>
												<td class="text-right font-bold text-primary">%{{ rate.rate }}</td>
											</tr>
										{% endfor %}
									</tbody>
								</table>
							</div>
						</div>
					</div>
				{% endif %}
			{% endif %}

			{# Info Box #}
			<div class="mt-8 text-xs text-center opacity-50">
				<p>{% trans %}Source: TCMB EVDS (Electronic Data Delivery System){% endtrans %}</p>
				<p>{% trans %}Data Series: TP.FG.J0 (Consumer Price Index){% endtrans %}</p>
			</div>
		</div>
	</div>
</div>
